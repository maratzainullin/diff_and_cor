# -var l 2.8712 -var t 700
# -var l 2.8947 -var t 1300
# -var l 2.9151 -var t 1700
#------------------------------------------------
variable i loop 0 10000 #число рестартов
variable time_step equal 1000*$i
variable time_step_previous equal 1000*$i-1000
# shell rm ./data/restarts_$t/${time_step_previous}
shell while [ ! -f ./data/restarts_$t/${time_step} ]; do sleep 0.5; done  #ждет, пока не создастся след рестарт
# variable time_step_previous equal 1000*$i-1000
#------------------------------------------------
read_restart ./data/restarts_$t/${time_step}
pair_style      eam/fs
pair_coeff      * * ../Fe_mm.eam.fs Fe
min_style cg
minimize 1e-9 1e-9 5000 5000
compute cna all cna/atom 3.45
compute 2 all reduce sum c_cna
thermo_style    custom step temp pe c_2
run 0
#------------------------------------------------
variable cnat atom "c_cna != 3.0"
group sia_surround variable cnat
dump		after_min_sia sia_surround custom 1 ./data/dumps_$t/surr_sia.dump x y z
dump_modify after_min_sia append yes

compute comV sia_surround com
# compute med_x sia_surround reduce ave x
# compute med_y sia_surround reduce ave y
# compute med_z sia_surround reduce ave z
thermo_style custom step temp pe c_comV[1] c_comV[2] c_comV[3] # c_med_x c_med_y c_med_z
run 0
variable comX equal c_comV[1]
variable comY equal c_comV[2]
variable comZ equal c_comV[3]
# variable med_x equal c_med_x
# variable med_y equal c_med_y
# variable med_z equal c_med_z
variable time equal ${time_step}/1000
variable ts equal time
print "${time};${comX};${comY};${comZ}" append ./data/other_$t/coords
# print "${time};${med_x};${med_y};${med_z}" append ./data/other_$t/unw_coords
clear
shell rm ./data/restarts_$t/${time_step}
next i
jump r2d.lmp
